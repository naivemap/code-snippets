{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"\u5f00\u59cb","text":"<p>Welcome to Code Snippets.</p>"},{"location":"tags/","title":"\u6807\u7b7e","text":""},{"location":"tags/#tag:gis","title":"GIS","text":"<ul> <li>            PostGIS          </li> <li>            ST_AsImage          </li> <li>            TiTiler          </li> </ul>"},{"location":"JavaScript/","title":"JavaScript","text":""},{"location":"JavaScript/Performance/","title":"Performance","text":""},{"location":"JavaScript/Performance/#_1","title":"\u751f\u6210\u968f\u673a\u6574\u6570","text":""},{"location":"JavaScript/Performance/#mathfloor","title":"Math.floor","text":"<pre><code>const i = Math.floor(Math.random() * 100);\n</code></pre>"},{"location":"JavaScript/Performance/#_2","title":"\u4f4d\u8fd0\u7b97","text":"<pre><code>const i = (Math.random() * 100) | 0;\n</code></pre> <p>\u63d0\u793a</p> <p><code>| 0</code>\u8fd9\u4e2a\u6280\u5de7\u662f\u4e00\u4e2a\u6027\u80fd\u4f18\u5316\u7684\u65b9\u6848\uff0c\u6bd4\u4f7f\u7528 <code>Math.floor()</code> \u8981\u5feb\u3002\u9002\u5408\u5728\u5728\u6027\u80fd\u5173\u952e\u7684\u573a\u666f\u4f7f\u7528\uff0c\u5982\uff1a\u6e38\u620f\u6e32\u67d3\u5faa\u73af\u3001\u5927\u91cf\u6570\u636e\u5904\u7406\u7b49\u3002</p>"},{"location":"JavaScript/Performance/#_3","title":"\u66f4\u5feb\u539f\u56e0","text":""},{"location":"JavaScript/Performance/#_4","title":"\u5e95\u5c42\u5b9e\u73b0\u5dee\u5f02","text":"<ol> <li>\u4f4d\u8fd0\u7b97 | 0\uff1a<ol> <li>\u76f4\u63a5\u8f6c\u6362\u4e3a CPU \u7684\u4e00\u6761\u4f4d\u8fd0\u7b97\u6307\u4ee4</li> <li>\u64cd\u4f5c\u6570\u76f4\u63a5\u5728 CPU \u5bc4\u5b58\u5668\u4e2d\u5b8c\u6210</li> <li>\u4e0d\u9700\u8981\u51fd\u6570\u8c03\u7528\u5f00\u9500</li> </ol> </li> <li>Math.floor()<ol> <li>\u9700\u8981\u51fd\u6570\u8c03\u7528\u5f00\u9500  </li> <li>\u9700\u8981\u5904\u7406\u5404\u79cd\u8fb9\u754c\u60c5\u51b5\uff08\u5982 NaN\u3001Infinity \u7b49\uff09</li> </ol> </li> </ol>"},{"location":"JavaScript/Performance/#_5","title":"\u64cd\u4f5c\u6b65\u9aa4\u5bf9\u6bd4","text":"<pre><code>// Math.floor() \u7684\u8fc7\u7a0b\nlet x = 3.7;\nMath.floor(x);  // \u6d89\u53ca\u4ee5\u4e0b\u6b65\u9aa4\uff1a\n// 1. \u67e5\u627e Math \u5bf9\u8c61\n// 2. \u8c03\u7528 floor \u51fd\u6570\n// 3. \u521b\u5efa\u8c03\u7528\u6808\n// 4. \u6267\u884c\u51fd\u6570\u903b\u8f91\n// 5. \u8fd4\u56de\u7ed3\u679c\n\n// | 0 \u7684\u8fc7\u7a0b\nlet x = 3.7;\nx | 0;  // \u76f4\u63a5\u8fdb\u884c\u4f4d\u8fd0\u7b97\uff0c\u4e00\u6b65\u5230\u4f4d\n</code></pre>"},{"location":"JavaScript/Performance/#_6","title":"\u9650\u5236\u548c\u6ce8\u610f\u4e8b\u9879","text":"<pre><code>// 1. 32\u4f4d\u6574\u6570\u8303\u56f4\u9650\u5236\nconsole.log(2147483647 | 0);      // 2147483647 (\u6700\u5927\u503c)\nconsole.log(2147483648 | 0);      // -2147483648 (\u6ea2\u51fa)\n\n// 2. \u4e0d\u652f\u6301\u5927\u6570\u5904\u7406\nconsole.log(Math.floor(Number.MAX_SAFE_INTEGER));  // 9007199254740991\nconsole.log(Number.MAX_SAFE_INTEGER | 0);          // -1 (\u9519\u8bef\u7ed3\u679c)\n\n// 3. \u53ea\u80fd\u7528\u4e8e\u6570\u5b57\u7c7b\u578b\nconst num = \"3.14\" | 0;     // \u53ef\u4ee5\u5de5\u4f5c\nconst invalid = \"abc\" | 0;  // \u7ed3\u679c\u4e3a 0\uff0c\u53ef\u80fd\u4e0d\u662f\u671f\u671b\u7684\u884c\u4e3a\n</code></pre>"},{"location":"JavaScript/Performance/#_7","title":"\u6700\u4f73\u5b9e\u8df5","text":"<pre><code>// \u63a8\u8350\u7684\u4f7f\u7528\u573a\u666f\nfunction fastIntegerConversion(value: number): number {\n    // \u5f53\u786e\u5b9a\u6570\u503c\u5728 32 \u4f4d\u6574\u6570\u8303\u56f4\u5185\u65f6\u4f7f\u7528 | 0\n    if (value &gt; -2147483648 &amp;&amp; value &lt; 2147483647) {\n        return value | 0;\n    }\n    // \u5176\u4ed6\u60c5\u51b5\u4f7f\u7528 Math.floor\n    return Math.floor(value);\n}\n</code></pre> <p>\u5728\u5b9e\u9645\u5f00\u53d1\u4e2d\uff0c\u9664\u975e\u5728\u6027\u80fd\u5173\u952e\u7684\u573a\u666f\uff08\u5982\u6e38\u620f\u6e32\u67d3\u5faa\u73af\u3001\u5927\u91cf\u6570\u636e\u5904\u7406\u7b49\uff09\uff0c\u5426\u5219\u53ef\u8bfb\u6027\u901a\u5e38\u6bd4\u8fd9\u79cd\u5fae\u4f18\u5316\u66f4\u91cd\u8981\u3002</p>"},{"location":"Python/TiTiler/","title":"TiTiler","text":"<p>TiTiler: A modern dynamic tile server built on top of FastAPI and Rasterio/GDAL.</p>","tags":["GIS"]},{"location":"Python/TiTiler/#cog","title":"/cog","text":"","tags":["GIS"]},{"location":"Python/TiTiler/#colormap","title":"colormap","text":"","tags":["GIS"]},{"location":"Python/TiTiler/#_1","title":"\u79bb\u6563","text":"<pre><code>const colormap = encodeURIComponent(\n  JSON.stringify({\n    0: \"#f00\",\n    1: \"#0f0\",\n    2: \"#00f\",\n  })\n);\n</code></pre>","tags":["GIS"]},{"location":"Python/TiTiler/#_2","title":"\u7ebf\u6027","text":"<pre><code>// \u4ece 0 \u5230 255 \u7684 256 \u4e2a\u503c\nconst linearColors: Record&lt;number, string&gt; = {};\nfor (let i = 0; i &lt; 256; i++) {\n  colormap[i] = `#${i.toString(16).padStart(2, \"0\")}0000`;\n}\n\ncolormap = encodeURIComponent(JSON.stringify(linearColors));\n</code></pre>","tags":["GIS"]},{"location":"Python/TiTiler/#_3","title":"\u533a\u95f4","text":"<pre><code>const colormap = JSON.stringify([\n  // [[min, max], [r, g, b, a]]\n  [[0, 40], \"#FF0000\"],\n  [\n    [40, 200],\n    [0, 255, 0, 255],\n  ],\n  [\n    [200, 255],\n    [0, 0, 255, 255],\n  ],\n]);\n</code></pre>","tags":["GIS"]},{"location":"SQL/","title":"SQL","text":""},{"location":"SQL/Ganos/","title":"\u65f6\u7a7a\u5f15\u64ce\uff08GanosBase\uff09","text":""},{"location":"SQL/Ganos/ST_AsImage/","title":"ST_AsImage","text":"<p>\u5c06\u6805\u683c\u5bf9\u8c61\u8f6c\u5316\u4e3a\u5f71\u50cf\u683c\u5f0f\u4e8c\u8fdb\u5236\u6d41\u3002</p> <pre><code>SELECT\n    encode(\n        ST_AsImage (\n            rast,\n            '(140.025,60.025),(69.975,-0.025)' :: box\n            0,\n            '0',\n            'jpeg',\n            '{\"strength\": \"ratio\", \"quality\": 70}'\n        ),\n        'hex'\n    )\nFROM\n    surf_hor_metadata\nWHERE\n    ele = 'PRE'\n</code></pre>","tags":["GIS"]},{"location":"SQL/PostGIS/","title":"PostGIS","text":"","tags":["GIS"]},{"location":"SQL/PostGIS/#_1","title":"\u5b89\u88c5","text":"<pre><code>CREATE SCHEMA postgis;\nGRANT USAGE ON schema postgis to public;\n\nCREATE EXTENSION postgis SCHEMA postgis;\nCREATE EXTENSION postgis_raster SCHEMA postgis;\n\nALTER DATABASE postgis_in_action SET search_path=public,postgis,contrib;\n</code></pre> <p>\u63d0\u793a</p> <p>\u867d\u7136\u4e0d\u662f\u5fc5\u9700\u7684\uff0c\u4f46\u5efa\u8bae\u5728\u5355\u72ec\u7684\u6a21\u5f0f\uff08\u5982 postgis\uff09\u4e2d\u5b89\u88c5 postgis\uff0c\u8fd9\u6837\u51fd\u6570\u5c31\u4e0d\u4f1a\u5f04\u4e71\u9ed8\u8ba4\u7684\u516c\u5171\u6a21\u5f0f\u3002</p>","tags":["GIS"]},{"location":"SQL/PostGIS/#_2","title":"\u67e5\u8be2\u6570\u636e\u5e93\u4e0b\u6240\u6709\u7a7a\u95f4\u8868","text":"<pre><code>WITH columns AS (\n    SELECT\n        ns.nspname AS table_schema, -- \u6a21\u5f0f\n        cls.relname AS table_name, -- \u8868\u540d\n        cls.reltuples AS tuples, -- \u8bb0\u5f55\u6570\n        des.description AS description, -- \u8868\u63cf\u8ff0\n        attr.attname AS column_name, -- \u5217\u540d\n        col_description(attr.attrelid, attr.attnum) AS column_comment, -- \u5217\u63cf\u8ff0\n        trim(leading '_' from tp.typname) AS column_type -- \u5217\u7c7b\u578b\n    FROM pg_catalog.pg_attribute attr\n        JOIN pg_catalog.pg_class AS cls ON cls.oid = attr.attrelid\n        JOIN pg_catalog.pg_namespace AS ns ON ns.oid = cls.relnamespace\n        JOIN pg_catalog.pg_type AS tp ON tp.oid = attr.atttypid\n        JOIN pg_catalog.pg_description AS des ON cls.oid = des.objoid AND des.objsubid = 0\n    WHERE\n        NOT attr.attisdropped\n        AND attr.attnum &gt; 0\n        AND cls.relname NOT LIKE 'pg_%'\n        AND ns.nspname NOT IN ('pg_catalog', 'information_schema')\n        -- AND ns.nspname = 'other'\n        -- AND cls.relname like 'flash_flood_hazard_point'\n)\nSELECT\n    f_table_name as id,\n    f_table_schema as workspace,\n    f_table_name as data_name,\n    columns.description as description,\n    columns.tuples as tuples,\n    f_geometry_column as geometry_column,\n    type as geometry_type,\n    srid,\n    jsonb_object_agg(\n        columns.column_name,\n        json_build_object(\n            'type',columns.column_type,\n            'title',columns.column_comment\n        )\n    ) AS fields\nFROM postgis.geometry_columns as gc\n    JOIN columns ON\n        gc.f_table_schema = columns.table_schema AND\n        gc.f_table_name = columns.table_name AND\n        gc.f_geometry_column != columns.column_name\nGROUP BY f_table_schema, f_table_name, description, tuples, f_geometry_column, srid, type\n</code></pre>","tags":["GIS"]},{"location":"SQL/PostgreSQL/","title":"PostgreSQL","text":""},{"location":"SQL/PostgreSQL/#_1","title":"\u4fee\u6539\u5b57\u6bb5\u7c7b\u578b","text":""},{"location":"SQL/PostgreSQL/#_2","title":"\u4e0d\u5e26\u8f6c\u6362","text":"<pre><code>ALTER TABLE table_name ALTER COLUMN column_name TYPE new_type;\n</code></pre>"},{"location":"SQL/PostgreSQL/#_3","title":"\u5e26\u8f6c\u6362","text":"<pre><code>ALTER TABLE table_name ALTER COLUMN column_name TYPE new_type USING column_name::new_type;\n</code></pre>"},{"location":"Tool/","title":"\u5de5\u5177","text":""},{"location":"Tool/nginx/","title":"nginx","text":""},{"location":"Tool/nginx/#_1","title":"\u547d\u4ee4","text":"<p>\u67e5\u770b nginx \u7684\u7248\u672c\u53f7</p> <pre><code>nginx -v\n</code></pre> <p>\u542f\u52a8 nginx</p> <pre><code>start nginx\n</code></pre> <p>\u5feb\u901f\u505c\u6b62\u6216\u5173\u95ed nginx</p> <pre><code>nginx -s stop\n</code></pre> <p>\u6b63\u5e38\u505c\u6b62\u6216\u5173\u95ed nginx</p> <pre><code>nginx -s quit\n</code></pre> <p>\u914d\u7f6e\u6587\u4ef6 nginx.conf \u4fee\u6539\u91cd\u88c5\u8f7d\u547d\u4ee4</p> <pre><code>nginx -s reload\n</code></pre>"}]}